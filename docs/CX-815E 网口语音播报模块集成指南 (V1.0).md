# CX-815E 网口语音播报模块集成指南 (V1.0)

## 1. 模块概览

CX-815E 是一款基于 TCP/IP 的工业级 TTS 语音合成模块 。它能将接收到的文本实时转换为语音，并支持多种控制指令（音量、语速、发音人） 。

### 硬件参数要点

*
**供电**： 。


*
**音频输出**：无源喇叭（最大 ）或  有源音频接口 。


*
**通信接口**： RJ45 网口 。


*
**默认配置**：通常工作在 TCP Server 模式，端口号 `50000`（自由协议）或 `502`（Modbus） 。



---

## 2. 通信协议规范 (自由协议)

这是实现自动化集成最简单高效的协议。支持文本透传及参数嵌入。

### 2.1 基础播报指令

发送格式必须为：`字符头(#) + 文本内容` 。

*
**单次播报**：`#你好` 。


*
**多次播报**：使用多个 `#` 作为头，例如 `##请注意` 播报 2 次，`###请注意` 播报 3 次 。


*
**编码要求**：支持 GB2312（默认）、UTF-8 等，需在配置软件中确认 。



### 2.2 内置提示音播报

发送格式：`#sound[ID]` 。

* **常用 ID**：
*
`sound101`: 警报 (0.8s) 。


*
`sound107`: 警报紧急 (0.8s) 。


*
`sound108`: 叮咚 (1.2s) 。


*
`sound901`: 短促蜂鸣 (0.05s) 。





### 2.3 TTS 控制标识符 (内嵌于文本)

通过在文本中加入 `[x]` 格式的标记符实时改变合成参数 。

| 功能 | 标识符 | 取值范围 | 示例 |
| --- | --- | --- | --- |
| **音量** | `[v*]` | 0-10

 | `[v10]最大音量播报` |
| **语速** | `[s*]` | 0-10

 | `[s8]语速较快` |
| **发音人** | `[m*]` | 3(女), 51(男)

 | `[m51]你好我是男声` |
| **静音** | `[p*]` | 毫秒数

 | `第一句[p500]第二句` |

---

## 3. 自动化集成逻辑 (State Machine)

Code Agent 在开发集成逻辑时应遵循以下状态反馈：

1. **建立连接**：建立 TCP 连接至 `设备IP:50000`。
2. **发送数据**：发送指令字节流（注意字符编码转换）。
3. **接收反馈**：
* 收到 `4F 4B` (Hex): 表示指令已成功解析，设备开始播报 。


* 收到 `4F 4C` (Hex): 表示物理播报已结束 。




4. **并发处理**：
*
**打断模式**：新指令会立即中断当前播报 。


*
**缓存模式**：最多支持缓存 20 条指令 。





---

## 4. 系统管理指令 (Hex 格式)

部分底层控制需通过十六进制指令发送：

*
**设置打断模式**：`CC DD F3 00` 。


*
**设置缓存模式**：`CC DD F3 01` 。


*
**重启语音芯片**：`CC DD F7` 。


*
**心跳包格式**：`A5 00 12 59 4A [12字节MAC ASCII] [校验和]` 。



---

## 5. Node.js 参考实现片段

```javascript
const net = require('net');
const iconv = require('iconv-lite'); // 核心：处理 GB2312 转码

const client = new net.Socket();
client.connect(50000, '192.168.0.18', () => {
    // 示例：设置音量 10 并在播报前加入叮咚声
    const msg = '#[v10]sound108 任务已完成';
    client.write(iconv.encode(msg, 'gb2312'));
});

client.on('data', (data) => {
    if (data.includes(Buffer.from([0x4F, 0x4C]))) {
        console.log('播报任务彻底完成');
        client.destroy();
    }
});

```

这份文档为 **Code Agent** 提供了关于 CX-815E 语音模块处理中文多音字及特殊读音纠错的集成指南。

---

# CX-815E TTS 语音纠错与多音字处理集成文档

## 1. 核心纠错机制

CX-815E 模块主要通过 **TTS 标记符 (Tags)** 嵌入文本字符串来解决多音字误读、数字歧义及姓名读音问题 。所有标记符必须包含在 `[]` 内，且指令需以 `#` 开头 。

## 2. 方案 A：人工强制拼音标注（最高优先级）

当模块对特定多音字（如“弹”、“行”、“重”）识别错误时，可直接在汉字后强制指定拼音 。

*
**标记格式**：`汉字[→(拼音 + 声调)]`


* **声调定义**：
*
`1`: 阴平 (一声)


*
`2`: 阳平 (二声)


*
`3`: 上声 (三声)


*
`4`: 去声 (四声)


*
`5`: 轻声




* **Code Agent 示例**：
* 强制“弹”读 **dàn**（如子弹）：`#子弹[→dan4]`


* 强制“弹”读 **tán**（如弹琴）：`#弹[→tan2]琴`





## 3. 方案 B：语义策略配置

模块支持通过全局或局部标识符调整合成引擎的语义理解逻辑 。

| 功能描述 | 标记符 | 参数说明 | 应用场景 |
| --- | --- | --- | --- |
| **姓名读音策略** | `[re*]` | <br>`0`: 自动判断；`1`: 强制开头字按姓氏读音；`2`: 强制紧跟字按姓氏读音

 | 用于解决人名多音字（如“仇”、“单”）

 |
| **数字处理策略** | `[ne*]` | <br>`0`: 自动判断；`1`: 作号码处理；`2`: 作数值处理

 | 解决“123”读作“一百二十三”还是“一二三”

 |
| **“1”的读法** | `[y*]` | <br>`0`: 读成“幺”；`1`: 读成“一”

 | 工业场景下号码中“1”的读音切换

 |
| **拼音模式使能** | `[ie*]` | <br>`0`: 不识别拼音；`1`: 识别汉语拼音

 | 使模块直接播报文本中的拼音字母

 |

## 4. 方案 C：韵律与风格微调

通过调整发音节奏，减少因语速过快导致的听感误判 。

*
**发音风格 `[f*]**`：`0` 为一字一顿，`1` 为平铺直叙 。


*
**韵律标注 `[z*]**`：`1` 为处理韵律。使用 `#` 标出短语划分位置，使用 `*` 标出词划分位置 。


* 示例：`#中[→zhong4]心*播报` 。





## 5. Agent 实现伪代码 (Node.js)

```javascript
// 处理多音字 "弹" 的业务逻辑封装
function generateTtsPayload(text) {
    // 业务预设纠错表
    const corrections = {
        '子弹': '子弹[→dan4]',
        '弹琴': '弹[→tan2]琴',
        '重庆': '重[→zhong4]庆'
    };

    let processedText = text;
    for (const [key, value] of Object.entries(corrections)) {
        processedText = processedText.replace(new RegExp(key, 'g'), value);
    }

    // 强制使用 [v10] 最大音量并返回带 # 的指令
    return `#[v10]${processedText}`;
}

```

## 6. 集成限制

*
**内容长度**：单次播报最多支持 500 字节 。


*
**字符限制**：拼音模式支持 1 至 6 位字母 + 1 位数字 。


*
**反馈机制**：发送带标记符的指令后，模块依然会先回复 `4F 4B` (OK) 。



是否需要我为你生成一份基于上述规则的常用多音字纠错映射表？
