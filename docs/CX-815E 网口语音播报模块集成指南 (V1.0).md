# CX-815E 网口语音播报模块集成指南 (V1.0)

## 1. 模块概览

CX-815E 是一款基于 TCP/IP 的工业级 TTS 语音合成模块 。它能将接收到的文本实时转换为语音，并支持多种控制指令（音量、语速、发音人） 。

### 硬件参数要点

*
**供电**： 。


*
**音频输出**：无源喇叭（最大 ）或  有源音频接口 。


*
**通信接口**： RJ45 网口 。


*
**默认配置**：通常工作在 TCP Server 模式，端口号 `50000`（自由协议）或 `502`（Modbus） 。



---

## 2. 通信协议规范 (自由协议)

这是实现自动化集成最简单高效的协议。支持文本透传及参数嵌入。

### 2.1 基础播报指令

发送格式必须为：`字符头(#) + 文本内容` 。

*
**单次播报**：`#你好` 。


*
**多次播报**：使用多个 `#` 作为头，例如 `##请注意` 播报 2 次，`###请注意` 播报 3 次 。


*
**编码要求**：支持 GB2312（默认）、UTF-8 等，需在配置软件中确认 。



### 2.2 内置提示音播报

发送格式：`#sound[ID]` 。

* **常用 ID**：
*
`sound101`: 警报 (0.8s) 。


*
`sound107`: 警报紧急 (0.8s) 。


*
`sound108`: 叮咚 (1.2s) 。


*
`sound901`: 短促蜂鸣 (0.05s) 。





### 2.3 TTS 控制标识符 (内嵌于文本)

通过在文本中加入 `[x]` 格式的标记符实时改变合成参数 。

| 功能 | 标识符 | 取值范围 | 示例 |
| --- | --- | --- | --- |
| **音量** | `[v*]` | 0-10

 | `[v10]最大音量播报` |
| **语速** | `[s*]` | 0-10

 | `[s8]语速较快` |
| **发音人** | `[m*]` | 3(女), 51(男)

 | `[m51]你好我是男声` |
| **静音** | `[p*]` | 毫秒数

 | `第一句[p500]第二句` |

---

## 3. 自动化集成逻辑 (State Machine)

Code Agent 在开发集成逻辑时应遵循以下状态反馈：

1. **建立连接**：建立 TCP 连接至 `设备IP:50000`。
2. **发送数据**：发送指令字节流（注意字符编码转换）。
3. **接收反馈**：
* 收到 `4F 4B` (Hex): 表示指令已成功解析，设备开始播报 。


* 收到 `4F 4C` (Hex): 表示物理播报已结束 。




4. **并发处理**：
*
**打断模式**：新指令会立即中断当前播报 。


*
**缓存模式**：最多支持缓存 20 条指令 。





---

## 4. 系统管理指令 (Hex 格式)

部分底层控制需通过十六进制指令发送：

*
**设置打断模式**：`CC DD F3 00` 。


*
**设置缓存模式**：`CC DD F3 01` 。


*
**重启语音芯片**：`CC DD F7` 。


*
**心跳包格式**：`A5 00 12 59 4A [12字节MAC ASCII] [校验和]` 。



---

## 5. Node.js 参考实现片段

```javascript
const net = require('net');
const iconv = require('iconv-lite'); // 核心：处理 GB2312 转码

const client = new net.Socket();
client.connect(50000, '192.168.0.18', () => {
    // 示例：设置音量 10 并在播报前加入叮咚声
    const msg = '#[v10]sound108 任务已完成';
    client.write(iconv.encode(msg, 'gb2312'));
});

client.on('data', (data) => {
    if (data.includes(Buffer.from([0x4F, 0x4C]))) {
        console.log('播报任务彻底完成');
        client.destroy();
    }
});

```
