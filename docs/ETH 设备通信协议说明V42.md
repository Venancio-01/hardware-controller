# ETH 设备通信协议说明 V42

一、厂家简单协议

1、继电器输出控制

| 描述 | 闭合指令 | 断开指令 |
| --- | --- | --- |
| **第1路继电器** | `doon01` | `dooff01` |
| **第2路继电器** | `doon02` | `dooff02` |
| **第3路继电器** | `doon03` | `dooff03` |
| **第4路继电器** | `doon04` | `dooff04` |
| **第5路继电器** | `doon05` | `dooff05` |
| **第6路继电器** | `doon06` | `dooff06` |
| **第7路继电器** | `doon07` | `dooff07` |
| **第8路继电器** | `doon08` | `dooff08` |
| **板载所有继电器** | `doon99` | `dooff99` |
|

 |  |  |

2、继电器输出与开关量输入状态查询

*

**查询板载继电器的状态**: `dostatus`

* **回复示例**: `dostatus11000000`
*

**含义**: 表示第1、2路继电器闭合，第3-8路断开。

*

**查询开关量输入的状态**: `distatus`

* **回复示例**: `distatus11000000`
*

**含义**: 表示第1、2路输入触发，第3-8路输入未触发。

3、继电器输出延时控制

* **说明**: 最大支持99秒延时。
* **举例**:
*

`doon01t02`: 闭合第1路继电器，2秒后自行断开。

*

`doon02t99`: 闭合第2路继电器，99秒后自行断开。

---

二、厂家指令协议

1、基本格式

| 字节位置 | 1-2 | 3 | 4 | 5 | 6 | 7-14 | 15-16 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| **含义** | 帧头 | 源地址 | 目的地址 | 命令码 | 参数长度 | 参数码 | 校验码 |
| **典型值** | `AA BB` | `FF`/`00` | `00`/`FF` | CMD | `08` | (8字节) | CRC16 |
|

 |  |  |  |  |  |  |  |

**命令码说明:**

| 请求指令 | 命令码 | 应答指令 | 命令码 | 说明 |
| --- | --- | --- | --- | --- |
| 请求读继电器状态 | `01` | 应答读继电器状态 | `81` | 读取当前继电器开闭状态 |
| 请求写继电器状态 | `02` | 应答写继电器状态 | `82` | 控制继电器开闭 |
| 请求读开关量状态 | `03` | 应答读开关量状态 | `83` | 读取输入端口状态 |
| 重启设备 | `0x0A` | 应答重启设备 | `0x8A` | 软重启 |

2、写继电器闭合指令 (CMD: 0x02)

> **注意**: 以下指令为 Hex 格式，最后两位为 CRC 校验码。

| 描述 | 发送指令 (Request) | 应答指令 (Response) |
| --- | --- | --- |
| **写第1路闭合** | `AA BB FF 00 02 08 00 01 01 00 00 00 00 00 25 1F` | `AA BB 00 FF 82 08 00 01 01 00 00 00 00 00 46 F5` |
| **写第2路闭合** | `AA BB FF 00 02 08 00 01 02 01 00 00 00 00 E4 D3` | `AA BB 00 FF 82 08 00 01 02 01 00 00 00 00 87 39` |
| **写第3路闭合** | `AA BB FF 00 02 08 02 01 01 00 00 00 00 00 A4 C6` | `AA BB 00 FF 82 08 02 01 01 00 00 00 00 00 C7 20` |
| **写第4路闭合** | `AA BB FF 00 02 08 03 01 01 00 00 00 00 00 65 0A` | `AA BB 00 FF 82 08 03 01 00 01 00 00 00 00 06 E0` |
| **写第5路闭合** | `AA BB FF 00 02 08 04 01 00 01 00 00 00 00 24 EC` | `AA BB 00 FF 82 08 04 01 01 00 00 00 00 00 47 06` |
| **写第6路闭合** | `AA BB FF 00 02 08 05 01 01 00 00 00 00 00 E5 20` | `AA BB 00 FF 82 08 05 01 01 00 00 00 00 00 86 CA` |
| **写第7路闭合** | `AA BB FF 00 02 08 06 01 01 00 00 00 00 00 A5 35` | `AA BB 00 FF 82 08 06 01 01 00 00 00 00 00 C6 DF` |
| **写第8路闭合** | `AA BB FF 00 02 08 07 01 01 00 00 00 00 00 64 F9` | `AA BB 00 FF 82 08 07 01 01 00 00 00 00 00 07 13` |
| **写1-8路全闭合** | `AA BB FF 00 02 08 00 08 FF 00 00 00 A9 C1 00 00` | `AA BB 00 FF 82 08 00 08 FF 00 00 00 CA 2B 00 00` |

3、写继电器断开指令 (CMD: 0x02)

| 描述 | 发送指令 (Request) | 应答指令 (Response) |
| --- | --- | --- |
| **写第1路断开** | `AA BB FF 00 02 08 00 01 00 00 00 00 00 00 24 CE` | `AA BB 00 FF 82 08 00 01 00 00 00 00 00 00 47 24` |
| **写第2路断开** | `AA BB FF 00 02 08 01 01 00 00 00 00 00 00 E5 02` | `AA BB 00 FF 82 08 01 01 00 00 00 00 00 00 86 E8` |
| **写第3路断开** | `AA BB FF 00 02 08 02 01 00 00 00 00 A5 17 00 00` | `AA BB 00 FF 82 08 02 01 00 00 00 00 C6 FD 00 00` |
| **写第4路断开** | `AA BB FF 00 02 08 03 01 00 00 00 00 00 00 64 DB` | `AA BB 00 FF 82 08 03 01 00 00 00 00 00 00 07 31` |
| **写第5路断开** | `AA BB FF 00 02 08 04 01 00 00 00 00 00 25 3D` | `AA BB 00 FF 82 08 04 01 00 00 00 00 00 00 46 D7` |
| **写第6路断开** | `AA BB FF 00 02 08 05 01 00 00 00 00 00 00 E4 F1` | `AA BB 00 FF 82 08 05 01 00 00 00 00 87 1B 00 00` |
| **写第7路断开** | `AA BB FF 00 02 08 06 01 00 00 00 00 00 00 A4 E4` | `AA BB 00 FF 82 08 06 01 00 00 00 00 00 00 C7 0E` |
| **写第8路断开** | `AA BB FF 00 02 08 07 01 00 00 00 00 00 00 65 28` | `AA BB 00 FF 82 08 07 01 00 00 06 C2 00 00 00` |
| **写1-8路全断开** | `AA BB FF 00 02 08 00 08 00 00 00 00 BD CE 00 00` | `AA BB 00 FF 82 08 00 08 00 00 00 00 00 00 DE 24` |

4、查询继电器状态 (CMD: 0x01)

*

**查询指令**: `AA BB FF 00 01 08 00 08 00 00 00 00 00 00 4D C1`

* **应答示例**:
*

**全断开**: `AA BB 00 FF 81 08 00 08 00 00 00 00 00 00 2E 2B`

*

**全闭合**: `AA BB 00 FF 81 08 00 08 FF 00 00 00 00 00 3A 24`

*

**第1路闭合**: `AA BB 00 FF 81 08 00 08 01 00 00 00 00 00 2F FA`

*

**第1、2路闭合**: `AA BB 00 FF 81 08 00 08 03 00 00 00 00 00 2E 18`

5、读1-8路开关量状态 (CMD: 0x03)

*

**查询指令**: `AA BB FF 00 03 08 00 08 00 00 00 00 00 00 EC 0B`

* **应答示例**:
*

**全未触发**: `AA BB 00 FF 83 08 00 08 00 00 00 00 00 00 8F E1`

*

**第1路触发**: `AA BB 00 FF 83 08 00 08 01 00 00 00 00 00 8E 30`

*

**第2路触发**: `AA BB 00 FF 83 08 00 08 02 00 00 00 00 00 8E 03`
