# Product Guidelines - Node Switch

## 1. 日志与反馈风格
- **专业技术化**：系统日志应优先记录原始报文、状态码和关键路径，避免冗长的解释性描述。
- **结构化记录**：确保日志以 JSON 格式输出，便于通过 ELK 或其他日志分析工具进行检索。

## 2. 日志分类规范
为了便于故障排查，日志必须包含以下分类标签：
- `HARDWARE`: 所有与继电器和语音模块的底层 UDP/TCP 通信。
- `LOGIC`: 继电器状态管理、控制策略和业务流程。
- `SYSTEM`: 环境校验、进程生命周期和全局异常。

## 3. 硬件通信恢复策略
- **静默重试优先**：针对网络波动或偶尔的硬件丢包，系统应内置自动重试机制（如 3 次重试）。
- **阶梯式告警**：重试期间记录 DEBUG 日志；重试完全失败后才抛出 ERROR 级别日志。

## 4. 类型与校验规范
- **单一真理来源**：所有硬件通信协议（如 ETH 设备协议）必须有对应的 Zod Schema 校验。
- **配置一致性**：环境变量和外部配置在系统启动前必须通过完整性校验，非法配置应导致服务拒绝启动。

## 5. 命名约定
- 硬件指令函数应以 `cmd` 或 `send` 开头。
- 状态轮询逻辑应统一使用 `poll` 前缀。
