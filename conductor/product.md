# Initial Concept
A hardware communication service using Node.js/Bun + TypeScript for relay control and voice broadcast via UDP/TCP.

## 1. 产品愿景
为工业控制现场的设备管理人员提供一个基于 Bun + TypeScript 的高可靠硬件通信服务，实现对继电器控制和语音播报模块的精准管理。

## 2. 目标用户
- **主要用户**：工业控制现场设备管理人员。
- **用户需求**：需要稳定、低延迟的方式远程控制硬件，并能实时获取设备状态以确保生产安全。

## 3. 核心功能
- **实时监控与轮询**：自动轮询硬件设备状态，并对状态变化进行实时记录与异常告警。
- **基于状态机的任务调度**：使用 XState 驱动硬件轮询和业务流（如 ApplyAmmoFlow），提高系统的可预测性和鲁棒性。
- **高可靠控制**：通过 UDP/TCP 协议实现对 8 路继电器的开闭、延时控制，并集成语音播报模块。
- **安全状态初始化**：在系统启动时自动重置所有继电器状态，确保硬件设备从已知的安全状态开始运行。
- **协议安全校验**：所有硬件交互指令均通过 Zod Schema 进行严格校验，确保通信的稳健性。
- **深度可观察性**：基于 Pino 的结构化日志系统，提供详尽的运行轨迹，辅助快速定位故障。

## 4. 关键衡量指标 (KPI)
- **系统稳定性**：支持 7x24 小时连续运行，具备完善的服务自愈能力（如 systemd 重启）。
- **极低延迟**：硬件指令的下发与反馈处理延迟控制在 100ms 以内。
- **简易部署**：提供标准化的部署流程，支持快速在目标工业主机上运行。

## 5. 设计原则
- **可靠性优先**：针对少量设备提供极高的控制可靠性，确保指令必达且状态同步准确。
- **简洁易维护**：代码结构清晰，配置管理严格（Zod 校验），降低维护成本。
